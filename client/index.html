<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <title>ListMatic</title>

    <!-- üîê SERIAL + MACHINE LOCK + ONLINE ONLY PROTECTION -->
    <script src="updater.js"></script>
    <script>
        // Configuration
        const GIST_RAW_URL = 'https://gist.githubusercontent.com/hagerabdalla199-lab/fba544733b90253edbfc2678910c9de6/raw/license.json';
        const LOCAL_STORAGE_KEY = 'miami_panel_license';

        // ‚ö†Ô∏è Set to true to force clear any existing license (for testing)
        // Set to false after confirming activation works
        const FORCE_NEW_ACTIVATION = false;

        if (FORCE_NEW_ACTIVATION) {
            localStorage.removeItem(LOCAL_STORAGE_KEY);
        }

        // Generate unique Machine ID based on browser/system info
        function generateMachineId() {
            const canvas = document.createElement('canvas');
            const ctx = canvas.getContext('2d');
            ctx.textBaseline = 'top';
            ctx.font = '14px Arial';
            ctx.fillText('MiamiPanel', 2, 2);
            const canvasData = canvas.toDataURL();

            const navigatorInfo = [
                navigator.userAgent,
                navigator.language,
                screen.width + 'x' + screen.height,
                screen.colorDepth,
                new Date().getTimezoneOffset()
            ].join('|');

            // Simple hash function
            let hash = 0;
            const str = canvasData + navigatorInfo;
            for (let i = 0; i < str.length; i++) {
                const char = str.charCodeAt(i);
                hash = ((hash << 5) - hash) + char;
                hash = hash & hash;
            }

            // Convert to readable format: MPID-XXXX-XXXX
            const id = Math.abs(hash).toString(16).toUpperCase().padStart(8, '0');
            return 'MPID-' + id.substring(0, 4) + '-' + id.substring(4, 8);
        }

        // Get stored license
        function getStoredLicense() {
            try {
                const data = localStorage.getItem(LOCAL_STORAGE_KEY);
                return data ? JSON.parse(data) : null;
            } catch (e) {
                return null;
            }
        }

        // Store license
        function storeLicense(serial, machineId) {
            localStorage.setItem(LOCAL_STORAGE_KEY, JSON.stringify({
                serial: serial,
                machineId: machineId,
                activatedAt: new Date().toISOString()
            }));
        }

        // Clear license
        function clearLicense() {
            localStorage.removeItem(LOCAL_STORAGE_KEY);
        }

        // Check internet connection
        async function checkInternet() {
            try {
                const response = await fetch('https://www.google.com/favicon.ico?t=' + Date.now(), {
                    mode: 'no-cors',
                    cache: 'no-store'
                });
                return true;
            } catch (e) {
                return false;
            }
        }

        // Main license check
        async function checkLicense() {
            const machineId = generateMachineId();

            // Step 1: Check Internet (REQUIRED)
            const hasInternet = await checkInternet();
            if (!hasInternet) {
                showError('no-internet', 'ŸÑÿß ŸäŸàÿ¨ÿØ ÿßÿ™ÿµÿßŸÑ ÿ®ÿßŸÑÿ•ŸÜÿ™ÿ±ŸÜÿ™', 'Ÿäÿ¨ÿ® ÿ™ŸàŸÅÿ± ÿßÿ™ÿµÿßŸÑ ÿ•ŸÜÿ™ÿ±ŸÜÿ™ ŸÑÿ™ÿ¥ÿ∫ŸäŸÑ ÿßŸÑÿ®ÿßŸÜŸÑ', machineId);
                return false;
            }

            // Step 2: Fetch license data from Gist
            let licenseData;
            try {
                const response = await fetch(GIST_RAW_URL + '?t=' + Date.now());
                if (!response.ok) throw new Error('Failed to fetch');
                licenseData = await response.json();
            } catch (e) {
                showError('server-error', 'ÿÆÿ∑ÿ£ ŸÅŸä ÿßŸÑÿßÿ™ÿµÿßŸÑ ÿ®ÿßŸÑÿ≥Ÿäÿ±ŸÅÿ±', 'ÿ™ÿπÿ∞ÿ± ÿßŸÑÿßÿ™ÿµÿßŸÑ ÿ®ÿÆÿßÿØŸÖ ÿßŸÑÿ™ÿ±ÿßÿÆŸäÿµ', machineId);
                return false;
            }

            // Step 3: Check if panel is globally disabled
            if (licenseData.enabled === false) {
                showError('disabled', 'ÿßŸÑÿ®ÿßŸÜŸÑ ŸÖÿπÿ∑ŸÑ', licenseData.message || 'ÿ™ŸàÿßÿµŸÑ ŸÖÿπ ÿßŸÑÿØÿπŸÖ', machineId);
                return false;
            }

            // Step 4: Check stored license
            const storedLicense = getStoredLicense();

            if (!storedLicense) {
                // No license stored, show activation screen
                showActivation(machineId, licenseData);
                return false;
            }

            // Step 5: Validate stored serial
            const validLicense = licenseData.licenses.find(l =>
                l.serial === storedLicense.serial &&
                l.machineId === machineId
            );

            if (!validLicense) {
                // Check if serial exists but for different machine
                const serialExists = licenseData.licenses.find(l => l.serial === storedLicense.serial);
                if (serialExists) {
                    clearLicense();
                    showError('wrong-machine', 'ÿ¨Ÿáÿßÿ≤ ÿ∫Ÿäÿ± ŸÖÿµÿ±ÿ≠', 'Ÿáÿ∞ÿß ÿßŸÑÿ≥Ÿäÿ±ŸäÿßŸÑ ŸÖÿ≥ÿ¨ŸÑ ÿπŸÑŸâ ÿ¨Ÿáÿßÿ≤ ÿ¢ÿÆÿ±', machineId);
                } else {
                    clearLicense();
                    showActivation(machineId, licenseData);
                }
                return false;
            }

            // Step 6: Check if blocked
            if (licenseData.blocked && licenseData.blocked.includes(storedLicense.serial)) {
                clearLicense();
                showError('blocked', 'ÿßŸÑÿ™ÿ±ÿÆŸäÿµ ŸÖÿ≠ÿ∏Ÿàÿ±', 'ÿ™ŸÖ ÿ≠ÿ∏ÿ± Ÿáÿ∞ÿß ÿßŸÑÿ™ÿ±ÿÆŸäÿµ. ÿ™ŸàÿßÿµŸÑ ŸÖÿπ ÿßŸÑÿØÿπŸÖ', machineId);
                return false;
            }

            // Step 7: Check if user is disabled
            if (validLicense.enabled === false) {
                const userMessage = validLicense.message || 'ÿ™ŸÖ ÿ™ÿπÿ∑ŸäŸÑ ÿ≠ÿ≥ÿßÿ®ŸÉ. ÿ™ŸàÿßÿµŸÑ ŸÖÿπ ÿßŸÑÿØÿπŸÖ';
                showError('user-disabled', 'ÿßŸÑÿ≠ÿ≥ÿßÿ® ŸÖÿπÿ∑ŸÑ', userMessage, machineId);
                return false;
            }

            // Step 8: Check expiry
            if (validLicense.expires) {
                const expiryDate = new Date(validLicense.expires);
                if (expiryDate < new Date()) {
                    showError('expired', 'ÿßŸÑÿ™ÿ±ÿÆŸäÿµ ŸÖŸÜÿ™ŸáŸä', 'ÿßŸÜÿ™Ÿáÿ™ ÿµŸÑÿßÿ≠Ÿäÿ© ÿßŸÑÿ™ÿ±ÿÆŸäÿµ ŸÅŸä ' + validLicense.expires, machineId);
                    return false;
                }
            }

            // Step 9: Store user name for welcome message
            if (validLicense.name) {
                localStorage.setItem('listmatic_user_name', validLicense.name);
            }

            // Step 10: Show global message if exists
            if (licenseData.globalMessage) {
                setTimeout(() => {
                    alert('üì¢ ' + licenseData.globalMessage);
                }, 1000);
            }

            // Step 11: Show user-specific message if exists
            if (validLicense.message) {
                setTimeout(() => {
                    alert('üí¨ ' + validLicense.message);
                }, 1500);
            }

            // ‚úÖ All checks passed!
            return true;
        }

        // Show activation screen
        function showActivation(machineId, licenseData) {
            const updateScreen = () => {
                const screen = document.getElementById('protection-screen');
                if (screen) {
                    screen.innerHTML = `
                        <div style="font-size:60px;margin-bottom:20px;">üîê</div>
                        <h1 style="color:#FF8A00;margin-bottom:10px;font-size:22px;font-weight:700;">ÿ™ŸÅÿπŸäŸÑ ListMatic</h1>
                        <p style="color:#9A9A9A;font-size:12px;margin-bottom:25px;">ÿ£ÿØÿÆŸÑ ÿßŸÑÿ≥Ÿäÿ±ŸäÿßŸÑ ŸÑÿ™ŸÅÿπŸäŸÑ ÿßŸÑÿ®ÿßŸÜŸÑ ÿπŸÑŸâ Ÿáÿ∞ÿß ÿßŸÑÿ¨Ÿáÿßÿ≤</p>
                        
                        <div style="background:rgba(255,138,0,0.1);border:1px solid rgba(255,138,0,0.3);border-radius:10px;padding:15px 20px;margin-bottom:20px;">
                            <p style="color:#FF8A00;font-size:10px;margin-bottom:5px;">üñ•Ô∏è Machine ID</p>
                            <p style="color:#FFB000;font-size:14px;font-weight:bold;font-family:monospace;">${machineId}</p>
                        </div>
                        
                        <input type="text" id="serial-input" placeholder="MIAMI-XXXX-XXXX-XXXX" 
                            style="width:280px;padding:14px 18px;background:#1a1a2e;border:2px solid #333;border-radius:10px;color:#fff;font-size:14px;text-align:center;font-family:monospace;letter-spacing:1px;margin-bottom:15px;outline:none;">
                        
                        <button onclick="activateLicense('${machineId}')" 
                            style="width:280px;padding:14px;background:linear-gradient(135deg, #FF8A00, #FFB000);border:none;border-radius:10px;color:#fff;font-size:14px;font-weight:700;cursor:pointer;">
                            ‚ö° ÿ™ŸÅÿπŸäŸÑ
                        </button>
                        
                        <p id="activation-error" style="color:#ef4444;font-size:11px;margin-top:15px;display:none;"></p>
                        
                        <p style="color:#555;font-size:10px;margin-top:30px;">ŸÑŸÑÿ≠ÿµŸàŸÑ ÿπŸÑŸâ ÿ≥Ÿäÿ±ŸäÿßŸÑÿå ÿ™ŸàÿßÿµŸÑ ŸÖÿπ ÿßŸÑŸÖÿ∑Ÿàÿ±</p>
                    `;
                    screen.style.display = 'flex';

                    // Store globally
                    window.licenseData = licenseData;
                    window.currentMachineId = machineId;
                }
            };

            if (document.readyState === 'loading') {
                document.addEventListener('DOMContentLoaded', updateScreen);
            } else {
                updateScreen();
            }
        }

        // Activate license
        async function activateLicense(machineId) {
            const serialInput = document.getElementById('serial-input');
            const errorElement = document.getElementById('activation-error');
            const serial = serialInput.value.trim();

            if (!serial) {
                errorElement.textContent = 'ÿßŸÑÿ±ÿ¨ÿßÿ° ÿ•ÿØÿÆÿßŸÑ ÿßŸÑÿ≥Ÿäÿ±ŸäÿßŸÑ';
                errorElement.style.display = 'block';
                return;
            }

            // Re-fetch license data
            let licenseData;
            try {
                const response = await fetch(GIST_RAW_URL + '?t=' + Date.now());
                licenseData = await response.json();
            } catch (e) {
                errorElement.textContent = 'ÿÆÿ∑ÿ£ ŸÅŸä ÿßŸÑÿßÿ™ÿµÿßŸÑ ÿ®ÿßŸÑÿ≥Ÿäÿ±ŸÅÿ±';
                errorElement.style.display = 'block';
                return;
            }

            // Check if serial exists
            const license = licenseData.licenses.find(l => l.serial === serial);

            if (!license) {
                errorElement.textContent = 'ÿßŸÑÿ≥Ÿäÿ±ŸäÿßŸÑ ÿ∫Ÿäÿ± ÿµÿ≠Ÿäÿ≠';
                errorElement.style.display = 'block';
                return;
            }

            // Check if already used on another machine
            if (license.machineId && license.machineId !== machineId && license.machineId !== 'PENDING') {
                errorElement.textContent = 'Ÿáÿ∞ÿß ÿßŸÑÿ≥Ÿäÿ±ŸäÿßŸÑ ŸÖÿ≥ÿ™ÿÆÿØŸÖ ÿπŸÑŸâ ÿ¨Ÿáÿßÿ≤ ÿ¢ÿÆÿ±';
                errorElement.style.display = 'block';
                return;
            }

            // Check if blocked
            if (licenseData.blocked && licenseData.blocked.includes(serial)) {
                errorElement.textContent = 'Ÿáÿ∞ÿß ÿßŸÑÿ≥Ÿäÿ±ŸäÿßŸÑ ŸÖÿ≠ÿ∏Ÿàÿ±';
                errorElement.style.display = 'block';
                return;
            }

            // Success! Store and reload
            storeLicense(serial, machineId);

            // Show success and reload
            const screen = document.getElementById('protection-screen');
            if (screen) {
                screen.innerHTML = `
                    <div style="font-size:60px;margin-bottom:20px;">‚úÖ</div>
                    <h1 style="color:#22c55e;margin-bottom:10px;font-size:22px;">ÿ™ŸÖ ÿßŸÑÿ™ŸÅÿπŸäŸÑ ÿ®ŸÜÿ¨ÿßÿ≠!</h1>
                    <p style="color:#9A9A9A;font-size:12px;">ÿ¨ÿßÿ±Ÿä ÿ•ÿπÿßÿØÿ© ÿßŸÑÿ™ÿ≠ŸÖŸäŸÑ...</p>
                `;
            }

            setTimeout(() => location.reload(), 1500);
        }

        // Show error screen
        function showError(type, title, message, machineId) {
            const icons = {
                'no-internet': 'üåê',
                'server-error': '‚ö†Ô∏è',
                'disabled': 'üîí',
                'wrong-machine': 'üíª',
                'blocked': 'üö´',
                'expired': '‚è∞'
            };

            const updateScreen = () => {
                const screen = document.getElementById('protection-screen');
                if (screen) {
                    screen.innerHTML = `
                        <div style="font-size:60px;margin-bottom:20px;">${icons[type] || '‚ùå'}</div>
                        <h1 style="color:#ef4444;margin-bottom:10px;font-size:18px;font-weight:700;">${title}</h1>
                        <p style="color:#9A9A9A;font-size:12px;margin-bottom:20px;max-width:300px;">${message}</p>
                        
                        ${machineId ? `
                        <div style="background:rgba(255,255,255,0.05);border:1px solid #333;border-radius:8px;padding:12px 20px;margin-bottom:20px;">
                            <p style="color:#666;font-size:9px;margin-bottom:3px;">Machine ID</p>
                            <p style="color:#888;font-size:11px;font-family:monospace;">${machineId}</p>
                        </div>
                        ` : ''}
                        
                        <button onclick="location.reload()" 
                            style="padding:12px 30px;background:#333;border:1px solid #444;border-radius:8px;color:#fff;font-size:12px;cursor:pointer;">
                            üîÑ ÿ•ÿπÿßÿØÿ© ÿßŸÑŸÖÿ≠ÿßŸàŸÑÿ©
                        </button>
                    `;
                    screen.style.display = 'flex';
                }
            };

            if (document.readyState === 'loading') {
                document.addEventListener('DOMContentLoaded', updateScreen);
            } else {
                updateScreen();
            }
        }

        // Run check immediately when script loads
        (async function () {
            // Show body with protection screen visible
            document.addEventListener('DOMContentLoaded', async () => {
                document.body.style.display = 'block';

                const valid = await checkLicense();

                if (valid) {
                    // License valid - hide protection, show main content
                    document.getElementById('protection-screen').style.display = 'none';
                    document.getElementById('main-content').style.display = 'block';
                    console.log('‚úÖ License valid');
                }
                // If not valid, checkLicense already showed the appropriate screen
            });
        })();
    </script>


    <style>
        @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;600;800&family=Rajdhani:wght@400;500;600;700&display=swap');

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            /* Cyberpunk Color Palette */
            --bg-1: #0B0B0E;
            --bg-2: #111114;
            --bg-3: #18181C;
            --bg-4: #1F1F24;
            --accent-1: #FF8A00;
            --accent-2: #FFB000;
            --accent-glow: rgba(255, 138, 0, 0.4);
            --cyan: #00D4FF;
            --green: #00FF88;
            --yellow: #FFD700;
            --orange: #FF6B00;
            --red: #FF3366;
            --pink: #FF0080;
            --text-1: #FFFFFF;
            --text-2: #B0B0B0;
            --text-3: #6A6A75;
            --border: rgba(255, 138, 0, 0.2);
            --border-glow: rgba(255, 138, 0, 0.4);
            --glow: rgba(255, 138, 0, 0.25);
            --glass: rgba(17, 17, 20, 0.85);
        }

        body {
            font-family: 'Rajdhani', 'Segoe UI', system-ui, sans-serif;
            background: var(--bg-1);
            background-image:
                radial-gradient(ellipse at 20% 0%, rgba(255, 138, 0, 0.08) 0%, transparent 50%),
                radial-gradient(ellipse at 80% 100%, rgba(255, 138, 0, 0.05) 0%, transparent 50%);
            color: var(--text-1);
            font-size: 11px;
            line-height: 1.4;
            min-height: 100vh;
        }

        /* ===== HEADER ===== */
        .header {
            background: var(--glass);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            padding: 16px 20px;
            border-bottom: 1px solid var(--border);
            display: flex;
            align-items: center;
            justify-content: space-between;
            position: relative;
        }

        .header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, var(--accent-1), var(--accent-2), var(--yellow), var(--accent-1));
            background-size: 200% 100%;
            animation: gradientMove 3s ease infinite;
        }

        @keyframes gradientMove {

            0%,
            100% {
                background-position: 0% 50%;
            }

            50% {
                background-position: 100% 50%;
            }
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .logo-icon {
            width: 44px;
            height: 44px;
            background: linear-gradient(135deg, var(--accent-1), var(--accent-2));
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 22px;
            box-shadow: 0 0 20px var(--accent-glow), inset 0 0 15px rgba(255, 255, 255, 0.1);
            animation: pulse 2s ease-in-out infinite;
        }

        @keyframes pulse {

            0%,
            100% {
                box-shadow: 0 0 20px var(--accent-glow);
            }

            50% {
                box-shadow: 0 0 30px var(--accent-glow), 0 0 40px rgba(255, 138, 0, 0.2);
            }
        }

        .logo h1 {
            font-family: 'Orbitron', sans-serif;
            font-size: 18px;
            font-weight: 700;
            letter-spacing: 2px;
            text-transform: uppercase;
            background: linear-gradient(90deg, var(--accent-1), var(--accent-2));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .logo span {
            display: block;
            font-size: 9px;
            color: var(--text-3);
            text-transform: uppercase;
            letter-spacing: 3px;
            font-weight: 600;
        }

        .version {
            background: linear-gradient(135deg, var(--accent-1), var(--accent-2));
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 9px;
            font-weight: 700;
            font-family: 'Orbitron', sans-serif;
            box-shadow: 0 0 15px var(--accent-glow);
            letter-spacing: 1px;
        }

        /* ===== TABS ===== */
        .tabs {
            display: flex;
            background: var(--glass);
            backdrop-filter: blur(10px);
            padding: 10px;
            gap: 6px;
            border-bottom: 1px solid var(--border);
        }

        .tab {
            flex: 1;
            padding: 12px 8px;
            text-align: center;
            font-size: 10px;
            font-weight: 700;
            cursor: pointer;
            border-radius: 8px;
            color: var(--text-3);
            transition: all 0.3s ease;
            border: 1px solid transparent;
            text-transform: uppercase;
            letter-spacing: 1px;
            position: relative;
            overflow: hidden;
        }

        .tab:hover {
            background: rgba(255, 138, 0, 0.1);
            color: var(--accent-1);
            border-color: var(--border);
        }

        .tab.active {
            background: linear-gradient(135deg, var(--accent-1), var(--accent-2));
            color: white;
            box-shadow: 0 0 20px var(--accent-glow);
            border: none;
        }

        .tab.active::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 60%;
            height: 2px;
            background: white;
            border-radius: 2px;
        }

        /* ===== CONTAINER ===== */
        .container {
            padding: 12px;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        /* ===== CARD ===== */
        .card {
            background: var(--glass);
            backdrop-filter: blur(10px);
            border: 1px solid var(--border);
            border-radius: 14px;
            padding: 16px;
            margin-bottom: 12px;
            transition: all 0.3s ease;
            position: relative;
        }

        .card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            border-radius: 14px;
            padding: 1px;
            background: linear-gradient(135deg, rgba(255, 138, 0, 0.3), transparent, rgba(255, 138, 0, 0.1));
            -webkit-mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
            mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
            -webkit-mask-composite: xor;
            mask-composite: exclude;
            pointer-events: none;
        }

        .card:hover {
            border-color: var(--border-glow);
            box-shadow: 0 5px 25px rgba(0, 0, 0, 0.3), 0 0 20px rgba(255, 138, 0, 0.1);
        }

        .card-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 14px;
            padding-bottom: 12px;
            border-bottom: 1px solid var(--border);
        }

        .card-icon {
            width: 30px;
            height: 30px;
            background: linear-gradient(135deg, var(--accent-1), var(--accent-2));
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            box-shadow: 0 0 10px var(--accent-glow);
        }

        .card-title {
            font-family: 'Orbitron', sans-serif;
            font-size: 11px;
            font-weight: 600;
            color: var(--accent-2);
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        /* ===== FORM ELEMENTS ===== */
        .form-row {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 10px;
        }

        .form-row:last-child {
            margin-bottom: 0;
        }

        .btn {
            padding: 11px 16px;
            background: var(--bg-3);
            border: 1px solid var(--border);
            border-radius: 8px;
            color: var(--text-1);
            font-size: 10px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            white-space: nowrap;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            position: relative;
            overflow: hidden;
        }

        .btn:hover {
            background: rgba(255, 138, 0, 0.15);
            border-color: var(--accent-1);
            color: var(--accent-1);
            box-shadow: 0 0 15px rgba(255, 138, 0, 0.2);
            transform: translateY(-1px);
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--accent-1), var(--accent-2));
            border: none;
            color: white;
        }

        .btn-primary:hover {
            opacity: 0.9;
            transform: translateY(-1px);
        }

        .btn-success {
            background: var(--green);
            border: none;
            color: white;
        }

        .btn-danger {
            background: var(--red);
            border: none;
            color: white;
        }

        .btn-warning {
            background: var(--yellow);
            border: none;
            color: black;
        }

        .input {
            flex: 1;
            padding: 10px 12px;
            background: var(--bg-3);
            border: 1px solid var(--border);
            border-radius: 8px;
            color: var(--text-1);
            font-size: 11px;
        }

        .input:focus {
            outline: none;
            border-color: var(--accent-1);
        }

        .input::placeholder {
            color: var(--text-3);
        }

        .label {
            flex: 0 0 80px;
            font-size: 10px;
            font-weight: 600;
            color: var(--text-2);
            text-transform: uppercase;
        }

        .file-label {
            flex: 1;
            padding: 10px 12px;
            background: var(--bg-3);
            border: 1px solid var(--border);
            border-radius: 8px;
            font-size: 10px;
            color: var(--text-3);
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        .file-label.selected {
            color: var(--green);
            border-color: var(--green);
        }

        .clear-btn {
            width: 32px;
            height: 32px;
            background: var(--bg-3);
            border: 1px solid var(--border);
            border-radius: 8px;
            color: var(--text-3);
            font-size: 14px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .clear-btn:hover {
            background: var(--red);
            border-color: var(--red);
            color: white;
        }

        /* ===== CHECKBOX GROUP ===== */
        .checkbox-group {
            display: flex;
            gap: 16px;
            justify-content: center;
        }

        .checkbox-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 6px;
            padding: 12px 20px;
            background: var(--bg-3);
            border: 1px solid var(--border);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .checkbox-item:hover {
            border-color: var(--accent-1);
        }

        .checkbox-item.active {
            border-color: var(--accent-1);
            background: rgba(108, 92, 231, 0.15);
        }

        .checkbox-item input {
            display: none;
        }

        .check-circle {
            width: 20px;
            height: 20px;
            border: 2px solid var(--border);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .checkbox-item.active .check-circle {
            background: var(--accent-1);
            border-color: var(--accent-1);
        }

        .checkbox-item.active .check-circle::after {
            content: '‚úì';
            color: white;
            font-size: 11px;
        }

        /* ===== GRID ===== */
        .grid-2 {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
        }

        .grid-3 {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 8px;
        }

        /* ===== SWATCHES ===== */
        .swatches {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
            justify-content: center;
            margin-top: 10px;
        }

        .swatch {
            width: 26px;
            height: 26px;
            border-radius: 6px;
            cursor: pointer;
            border: 2px solid transparent;
            transition: all 0.2s;
        }

        .swatch:hover {
            transform: scale(1.1);
            border-color: white;
        }

        /* ===== PROGRESS ===== */
        .progress-card {
            background: var(--glass);
            backdrop-filter: blur(10px);
            border: 1px solid var(--border);
            border-radius: 14px;
            padding: 16px;
            margin-bottom: 12px;
            position: relative;
        }

        .progress-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
        }

        .progress-title {
            font-family: 'Orbitron', sans-serif;
            font-size: 11px;
            font-weight: 600;
            color: var(--accent-2);
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .progress-percent {
            font-family: 'Orbitron', sans-serif;
            font-size: 16px;
            font-weight: 800;
            color: var(--accent-1);
            text-shadow: 0 0 10px var(--accent-glow);
        }

        .progress-bar {
            height: 10px;
            background: var(--bg-4);
            border-radius: 5px;
            overflow: hidden;
            margin-bottom: 12px;
            box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.3);
        }

        .progress-fill {
            height: 100%;
            width: 0%;
            background: linear-gradient(90deg, var(--accent-1), var(--accent-2), var(--yellow));
            background-size: 200% 100%;
            border-radius: 5px;
            transition: width 0.3s ease;
            animation: progressGlow 2s ease-in-out infinite;
            box-shadow: 0 0 10px var(--accent-glow);
        }

        @keyframes progressGlow {

            0%,
            100% {
                background-position: 0% 50%;
            }

            50% {
                background-position: 100% 50%;
            }
        }

        .progress-status {
            font-size: 10px;
            color: var(--text-3);
            margin-bottom: 12px;
            font-weight: 600;
        }

        .queue-btns {
            display: flex;
            gap: 10px;
        }

        .queue-btns .btn {
            flex: 1;
        }

        /* ===== RUN BUTTON ===== */
        .run-btn {
            width: 100%;
            padding: 16px;
            background: linear-gradient(135deg, var(--accent-1), var(--accent-2));
            border: none;
            border-radius: 12px;
            color: white;
            font-family: 'Orbitron', sans-serif;
            font-size: 12px;
            font-weight: 700;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 2px;
            box-shadow: 0 0 20px var(--accent-glow);
            position: relative;
            overflow: hidden;
        }

        .run-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.5s ease;
        }

        .run-btn:hover::before {
            left: 100%;
        }

        .run-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 30px var(--accent-glow), 0 0 40px rgba(255, 138, 0, 0.3);
        }

        .run-btn:disabled {
            background: var(--bg-4);
            color: var(--text-3);
            box-shadow: none;
        }

        .run-btn:disabled::before {
            display: none;
        }

        /* ===== STATUS ===== */
        .status {
            padding: 10px;
            border-radius: 8px;
            text-align: center;
            margin-top: 10px;
            font-size: 10px;
            font-weight: 600;
        }

        .status.success {
            background: rgba(0, 184, 148, 0.15);
            color: var(--green);
            border: 1px solid var(--green);
        }

        .status.error {
            background: rgba(214, 48, 49, 0.15);
            color: var(--red);
            border: 1px solid var(--red);
        }

        /* ===== STATS GRID ===== */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
        }

        .stat-card {
            background: var(--bg-3);
            padding: 14px;
            border-radius: 10px;
            text-align: center;
            border: 1px solid var(--border);
        }

        .stat-value {
            font-size: 22px;
            font-weight: 800;
        }

        .stat-value.purple {
            color: var(--accent-2);
        }

        .stat-value.green {
            color: var(--green);
        }

        .stat-value.red {
            color: var(--red);
        }

        .stat-value.yellow {
            color: var(--yellow);
        }

        .stat-label {
            font-size: 9px;
            color: var(--text-3);
            text-transform: uppercase;
            margin-top: 4px;
        }

        /* ===== TABLE ===== */
        .table-wrap {
            overflow-x: auto;
            border: 1px solid var(--border);
            border-radius: 8px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 10px;
        }

        th,
        td {
            padding: 10px 8px;
            text-align: left;
            border-bottom: 1px solid var(--border);
        }

        th {
            background: var(--bg-3);
            font-weight: 600;
            color: var(--text-2);
            text-transform: uppercase;
            font-size: 9px;
        }

        td input {
            width: 100%;
            padding: 6px;
            background: var(--bg-4);
            border: 1px solid var(--border);
            border-radius: 4px;
            color: var(--text-1);
            font-size: 10px;
        }

        /* ===== MAPPING GRID ===== */
        .mapping-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
        }

        .mapping-item {
            display: flex;
            flex-direction: column;
            gap: 4px;
        }

        .mapping-item label {
            font-size: 9px;
            color: var(--accent-2);
            text-transform: uppercase;
            font-weight: 600;
        }

        .mapping-item input {
            padding: 10px;
            background: var(--bg-3);
            border: 1px solid var(--border);
            border-radius: 8px;
            color: var(--text-1);
            font-size: 11px;
        }

        .mapping-item input:focus {
            outline: none;
            border-color: var(--accent-1);
        }

        /* ===== MAPPING ROW v3 ===== */
        .mapping-row {
            display: grid;
            grid-template-columns: 1fr 20px 1fr 30px;
            gap: 8px;
            align-items: center;
            margin-bottom: 8px;
            padding: 8px;
            background: var(--bg-3);
            border-radius: 8px;
            border: 1px solid var(--border);
        }

        .mapping-row input {
            padding: 8px 10px;
            background: var(--bg-2);
            border: 1px solid var(--border);
            border-radius: 6px;
            color: var(--text-1);
            font-size: 11px;
        }

        .mapping-row input:focus {
            outline: none;
            border-color: var(--accent-1);
        }

        .mapping-row .csv-col {
            border-color: var(--accent-2);
        }

        .mapping-row .layer-name {
            border-color: var(--accent-1);
        }

        .mapping-row .arrow {
            color: var(--accent-1);
            font-size: 14px;
            text-align: center;
        }

        .mapping-row .remove-btn {
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 6px;
            cursor: pointer;
            font-size: 12px;
            transition: all 0.2s;
        }

        .mapping-row .remove-btn:not(.disabled):hover {
            background: #FF4757;
            transform: scale(1.1);
        }

        .mapping-row .remove-btn.disabled {
            opacity: 0.3;
            cursor: default;
        }

        /* ===== PRESETS ===== */
        .preset-list {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }

        .preset-item {
            padding: 8px 14px;
            background: var(--bg-3);
            border: 1px solid var(--border);
            border-radius: 20px;
            font-size: 10px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .preset-item:hover {
            background: var(--accent-1);
            border-color: var(--accent-1);
            color: white;
        }

        /* ===== MATCHER ===== */
        .matcher-stats {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 8px;
            margin-bottom: 12px;
        }

        .matcher-stat {
            background: var(--bg-3);
            padding: 12px;
            border-radius: 8px;
            text-align: center;
            border: 1px solid var(--border);
        }

        .matcher-stat .value {
            font-size: 18px;
            font-weight: 800;
        }

        .matcher-stat .label {
            font-size: 8px;
            color: var(--text-3);
            text-transform: uppercase;
        }

        .match-results {
            max-height: 250px;
            overflow-y: auto;
            border: 1px solid var(--border);
            border-radius: 8px;
        }

        .match-row {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 10px;
            border-bottom: 1px solid var(--border);
            transition: background 0.2s;
        }

        .match-row:hover {
            background: var(--bg-3);
        }

        .match-row:last-child {
            border-bottom: none;
        }

        .match-row.matched {
            border-left: 3px solid var(--green);
        }

        .match-row.unmatched {
            border-left: 3px solid var(--red);
        }

        .match-num {
            width: 24px;
            font-size: 9px;
            color: var(--text-3);
        }

        .match-content {
            flex: 1;
            min-width: 0;
        }

        .match-brand {
            font-weight: 700;
            color: var(--cyan);
        }

        .match-model {
            color: var(--text-1);
        }

        .match-details {
            font-size: 9px;
            color: var(--text-3);
            margin-top: 2px;
        }

        .match-score {
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 9px;
            font-weight: 700;
        }

        .score-high {
            background: var(--green);
            color: white;
        }

        .score-medium {
            background: var(--yellow);
            color: black;
        }

        .score-low {
            background: var(--red);
            color: white;
        }

        .match-edit {
            width: 28px;
            height: 28px;
            background: var(--bg-4);
            border: 1px solid var(--border);
            border-radius: 6px;
            color: var(--text-2);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
        }

        .match-edit:hover {
            background: var(--accent-1);
            border-color: var(--accent-1);
            color: white;
        }

        /* ===== FOOTER ===== */
        .footer {
            text-align: center;
            padding: 16px;
            color: var(--text-3);
            font-size: 10px;
            font-weight: 600;
            border-top: 1px solid var(--border);
            background: var(--glass);
            letter-spacing: 0.5px;
        }

        .footer .heart {
            color: var(--accent-1);
            text-shadow: 0 0 10px var(--accent-glow);
            animation: heartbeat 1.5s ease-in-out infinite;
        }

        @keyframes heartbeat {

            0%,
            100% {
                transform: scale(1);
            }

            50% {
                transform: scale(1.2);
            }
        }

        /* ===== SCROLLBAR ===== */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }

        ::-webkit-scrollbar-track {
            background: var(--bg-2);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb {
            background: linear-gradient(135deg, var(--accent-1), var(--accent-2));
            border-radius: 4px;
            box-shadow: 0 0 5px var(--accent-glow);
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--accent-1);
            box-shadow: 0 0 10px var(--accent-glow);
        }

        /* ===== TEXTAREA ===== */
        .textarea {
            width: 100%;
            padding: 10px;
            background: var(--bg-3);
            border: 1px solid var(--border);
            border-radius: 8px;
            color: var(--text-1);
            font-size: 10px;
            font-family: monospace;
            resize: vertical;
            min-height: 80px;
        }

        .textarea:focus {
            outline: none;
            border-color: var(--accent-1);
        }

        /* ===== SESSION HISTORY ===== */
        .session-item {
            display: flex;
            justify-content: space-between;
            padding: 10px;
            background: var(--bg-3);
            border-radius: 8px;
            margin-bottom: 6px;
            font-size: 10px;
        }

        .session-item .count {
            color: var(--green);
            font-weight: 700;
        }

        .session-item .time {
            color: var(--text-3);
        }
    </style>
</head>

<body style="display:none;">
    <!-- Loading/Protection Screen (shown while checking) -->
    <div id="protection-screen"
        style="display:flex;flex-direction:column;align-items:center;justify-content:center;height:100vh;background:linear-gradient(135deg, #0B0B0E 0%, #1a1a2e 100%);color:#fff;font-family:'Segoe UI',sans-serif;text-align:center;padding:20px;position:fixed;top:0;left:0;right:0;bottom:0;z-index:99999;">
        <div style="font-size:50px;margin-bottom:20px;">‚è≥</div>
        <h1 style="color:#FF8A00;margin-bottom:10px;font-size:18px;">ÿ¨ÿßÿ±Ÿä ÿßŸÑÿ™ÿ≠ŸÇŸÇ...</h1>
        <p style="color:#9A9A9A;font-size:11px;">Checking license...</p>
    </div>

    <!-- Main Content Wrapper (hidden until verified) -->
    <div id="main-content" style="display:none;">
        <!-- Header -->
        <div class="header">
            <div class="logo">
                <div class="logo-icon">üöÄ</div>
                <div>
                    <h1>ListMatic V4</h1>
                    <span>FOR SYSTEMATIC WORK</span>
                </div>
            </div>
            <div style="display:flex;align-items:center;gap:10px;">
                <div id="update-btn" onclick="checkForUpdates()"
                    style="cursor:pointer;width:28px;height:28px;background:rgba(0,255,136,0.1);border-radius:6px;display:flex;align-items:center;justify-content:center;transition:all 0.2s;"
                    title="Check for Updates">
                    <span style="font-size:14px;">üîÑ</span>
                </div>
                <div id="update-status" style="font-size:10px;color:#00ff88;"></div>
            </div>
            <div style="display:flex;align-items:center;gap:15px;">
                <!-- Social Icons -->
                <div style="display:flex;gap:8px;">
                    <div onclick="openExternalURL('https://www.behance.net/abdallahager')" title="Behance"
                        style="width:28px;height:28px;background:rgba(0,87,255,0.15);border-radius:6px;display:flex;align-items:center;justify-content:center;cursor:pointer;transition:all 0.2s;"
                        onmouseover="this.style.background='rgba(0,87,255,0.3)';this.style.transform='scale(1.1)'"
                        onmouseout="this.style.background='rgba(0,87,255,0.15)';this.style.transform='scale(1)'">
                        <svg width="14" height="14" viewBox="0 0 24 24" fill="#0057FF">
                            <path
                                d="M22 7h-7v-2h7v2zm1.726 10c-.442 1.297-2.029 3-5.101 3-3.074 0-5.564-1.729-5.564-5.675 0-3.91 2.325-5.92 5.466-5.92 3.082 0 4.964 1.782 5.375 4.426.078.506.109 1.188.095 2.14h-8.027c.13 3.211 3.483 3.312 4.588 2.029h3.168zm-7.686-4h4.965c-.105-1.547-1.136-2.219-2.477-2.219-1.466 0-2.277.768-2.488 2.219zm-9.574 6.988h-6.466v-14.967h6.953c5.476.081 5.58 5.444 2.72 6.906 3.461 1.26 3.577 8.061-3.207 8.061zm-3.466-8.988h3.584c2.508 0 2.906-3-.312-3h-3.272v3zm3.391 3h-3.391v3.016h3.341c3.055 0 2.868-3.016.05-3.016z" />
                        </svg>
                    </div>
                    <div onclick="openExternalURL('https://www.facebook.com/abdalla.official/')" title="Facebook"
                        style="width:28px;height:28px;background:rgba(24,119,242,0.15);border-radius:6px;display:flex;align-items:center;justify-content:center;cursor:pointer;transition:all 0.2s;"
                        onmouseover="this.style.background='rgba(24,119,242,0.3)';this.style.transform='scale(1.1)'"
                        onmouseout="this.style.background='rgba(24,119,242,0.15)';this.style.transform='scale(1)'">
                        <svg width="14" height="14" viewBox="0 0 24 24" fill="#1877F2">
                            <path
                                d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385h-3.047v-3.47h3.047v-2.642c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953h-1.514c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385c5.737-.9 10.126-5.864 10.126-11.854z" />
                        </svg>
                    </div>
                    <div onclick="openExternalURL('https://wa.me/201122566691')" title="WhatsApp"
                        style="width:28px;height:28px;background:rgba(37,211,102,0.15);border-radius:6px;display:flex;align-items:center;justify-content:center;cursor:pointer;transition:all 0.2s;"
                        onmouseover="this.style.background='rgba(37,211,102,0.3)';this.style.transform='scale(1.1)'"
                        onmouseout="this.style.background='rgba(37,211,102,0.15)';this.style.transform='scale(1)'">
                        <svg width="14" height="14" viewBox="0 0 24 24" fill="#25D366">
                            <path
                                d="M.057 24l1.687-6.163c-1.041-1.804-1.588-3.849-1.587-5.946.003-6.556 5.338-11.891 11.893-11.891 3.181.001 6.167 1.24 8.413 3.488 2.245 2.248 3.481 5.236 3.48 8.414-.003 6.557-5.338 11.892-11.893 11.892-1.99-.001-3.951-.5-5.688-1.448l-6.305 1.654zm6.597-3.807c1.676.995 3.276 1.591 5.392 1.592 5.448 0 9.886-4.434 9.889-9.885.002-5.462-4.415-9.89-9.881-9.892-5.452 0-9.887 4.434-9.889 9.884-.001 2.225.651 3.891 1.746 5.634l-.999 3.648 3.742-.981zm11.387-5.464c-.074-.124-.272-.198-.57-.347-.297-.149-1.758-.868-2.031-.967-.272-.099-.47-.149-.669.149-.198.297-.768.967-.941 1.165-.173.198-.347.223-.644.074-.297-.149-1.255-.462-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.297-.347.446-.521.151-.172.2-.296.3-.495.099-.198.05-.372-.025-.521-.075-.148-.669-1.611-.916-2.206-.242-.579-.487-.501-.669-.51l-.57-.01c-.198 0-.52.074-.792.372s-1.04 1.016-1.04 2.479 1.065 2.876 1.213 3.074c.149.198 2.095 3.2 5.076 4.487.709.306 1.263.489 1.694.626.712.226 1.36.194 1.872.118.571-.085 1.758-.719 2.006-1.413.248-.695.248-1.29.173-1.414z" />
                        </svg>
                    </div>
                </div>
                <div class="version">v4.1</div>
            </div>
        </div>

        <!-- Tabs -->
        <div class="tabs">
            <div class="tab active" onclick="showTab('main')">Main</div>
            <div class="tab" onclick="showTab('matcher')">Matcher</div>
            <div class="tab" onclick="showTab('csv')">CSV</div>
            <div class="tab" onclick="showTab('settings')">Settings</div>
            <div class="tab" onclick="showTab('stats')">Stats</div>
        </div>

        <!-- ==================== MAIN TAB ==================== -->
        <div id="tab-main" class="tab-content active">
            <div class="container">
                <!-- Files -->
                <div class="card">
                    <div class="card-header">
                        <div class="card-icon">üìÅ</div>
                        <div class="card-title">Files</div>
                    </div>
                    <div class="form-row">
                        <button class="btn" onclick="selectFile('csv')">CSV</button>
                        <div class="file-label" id="lbl-csv">No file selected</div>
                        <button class="clear-btn" onclick="clearFile('csv')">√ó</button>
                    </div>
                    <div class="form-row">
                        <button class="btn" onclick="selectFolder('save')">Save</button>
                        <div class="file-label" id="lbl-save">No folder selected</div>
                        <button class="clear-btn" onclick="clearFile('save')">√ó</button>
                    </div>
                    <div class="form-row">
                        <button class="btn" onclick="selectFolder('imgs')">Images</button>
                        <div class="file-label" id="lbl-imgs">Optional</div>
                        <button class="clear-btn" onclick="clearFile('imgs')">√ó</button>
                    </div>
                </div>

                <!-- PSD Templates -->
                <div class="card">
                    <div class="card-header">
                        <div class="card-icon">üé®</div>
                        <div class="card-title">PSD Templates</div>
                    </div>
                    <div class="form-row">
                        <button class="btn" onclick="selectFile('fb')">Facebook</button>
                        <div class="file-label" id="lbl-fb">No file selected</div>
                        <button class="clear-btn" onclick="clearFile('fb')">√ó</button>
                    </div>
                    <div class="form-row">
                        <button class="btn" onclick="selectFile('ig')">Instagram</button>
                        <div class="file-label" id="lbl-ig">No file selected</div>
                        <button class="clear-btn" onclick="clearFile('ig')">√ó</button>
                    </div>
                    <div class="form-row">
                        <button class="btn" onclick="selectFile('tpl')">Template</button>
                        <div class="file-label" id="lbl-tpl">No file selected</div>
                        <button class="clear-btn" onclick="clearFile('tpl')">√ó</button>
                    </div>
                    <div class="form-row"
                        style="border-top:1px dashed rgba(0,212,255,0.3);padding-top:10px;margin-top:10px;">
                        <button class="btn" style="background:linear-gradient(135deg,#00D4FF,#00FFB3);color:#000;"
                            onclick="selectFile('catalog-tpl')">üì¶ Catalog</button>
                        <div class="file-label" id="lbl-catalog-tpl">Catalog Template (Optional)</div>
                        <button class="clear-btn" onclick="clearFile('catalog-tpl')">√ó</button>
                    </div>
                    <div id="catalog-settings"
                        style="display:none;margin-top:10px;padding:10px;background:rgba(0,212,255,0.05);border-radius:8px;">
                        <div class="grid-2">
                            <div class="mapping-item">
                                <label>Products/Page</label>
                                <input type="number" id="catalog-per-page" value="6" min="1" max="12">
                            </div>
                        </div>
                        <div style="margin-top:8px;font-size:9px;color:var(--text-3);">
                            Template needs: G1, G2, G3... groups with Brand, Model, Storage, Price, Image layers
                        </div>
                    </div>
                </div>

                <!-- Export Format -->
                <div class="card">
                    <div class="card-header">
                        <div class="card-icon">üíæ</div>
                        <div class="card-title">Export Format</div>
                    </div>
                    <div class="checkbox-group">
                        <div class="checkbox-item" onclick="toggleCheck(this,'exp-psd')">
                            <div class="check-circle"></div>
                            <span>PSD</span>
                        </div>
                        <div class="checkbox-item active" onclick="toggleCheck(this,'exp-jpg')">
                            <div class="check-circle"></div>
                            <span>JPG</span>
                        </div>
                        <div class="checkbox-item" onclick="toggleCheck(this,'exp-png')">
                            <div class="check-circle"></div>
                            <span>PNG</span>
                        </div>
                    </div>
                    <input type="checkbox" id="exp-psd" hidden>
                    <input type="checkbox" id="exp-jpg" hidden checked>
                    <input type="checkbox" id="exp-png" hidden>
                </div>

                <!-- Currency Settings -->
                <div class="card">
                    <div class="card-header">
                        <div class="card-icon">üí∞</div>
                        <div class="card-title">Currency Settings</div>
                    </div>
                    <div class="grid-2">
                        <div class="mapping-item">
                            <label>Scale %</label>
                            <input type="number" id="scale" value="100">
                        </div>
                        <div class="mapping-item">
                            <label>Color</label>
                            <input type="text" id="color" value="#ffffff">
                        </div>
                    </div>
                    <div class="grid-2" style="margin-top:10px;">
                        <button class="btn" onclick="pickColor()">üé® Picker</button>
                        <button class="btn" onclick="grabFG()">üîç Foreground</button>
                    </div>
                    <div class="swatches" id="swatches"></div>
                </div>

                <!-- Progress -->
                <div class="progress-card">
                    <div class="progress-header">
                        <div class="progress-title">‚ö° Processing</div>
                        <div class="progress-percent" id="progress-percent">0%</div>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="progress-fill"></div>
                    </div>
                    <div class="progress-status" id="progress-text">Ready</div>
                    <div class="queue-btns" style="text-align:center;">
                        <div
                            style="font-size:10px;color:var(--text-3);padding:8px;background:rgba(255,71,87,0.1);border-radius:8px;border:1px dashed rgba(255,71,87,0.3);">
                            ‚å®Ô∏è Press <span style="color:#FF4757;font-weight:700;">ESC</span> key to stop process
                        </div>
                    </div>
                </div>

                <button class="run-btn" id="run-btn" onclick="runProcess()">üöÄ Run & Process</button>
                <div class="status" id="status"></div>
            </div>
        </div>

        <!-- ==================== MATCHER TAB ==================== -->
        <div id="tab-matcher" class="tab-content">
            <div class="container">
                <!-- Open Web Version -->
                <button class="btn"
                    style="width:100%;margin-bottom:10px;background:linear-gradient(135deg,var(--pink),var(--orange));"
                    onclick="openWebMatcher()">üåê Open Full Web Version</button>

                <!-- Master Upload -->
                <div class="card">
                    <div class="card-header">
                        <div class="card-icon">üìã</div>
                        <div class="card-title">Master Sheet</div>
                    </div>
                    <div class="form-row">
                        <button class="btn" onclick="selectFile('master')">Select CSV</button>
                        <div class="file-label" id="lbl-master">No file selected</div>
                    </div>
                    <div id="master-status" style="margin-top:8px;font-size:10px;color:var(--green);display:none;">
                        ‚úÖ Loaded <span id="master-count">0</span> products
                    </div>
                </div>

                <!-- Input Data -->
                <div class="card">
                    <div class="card-header">
                        <div class="card-icon">üìù</div>
                        <div class="card-title">Unstructured Data</div>
                    </div>
                    <textarea id="input-data" class="textarea" rows="4"
                        placeholder="Paste product data here..."></textarea>
                    <div class="grid-3" style="margin-top:10px;">
                        <div class="mapping-item">
                            <label>Divisor</label>
                            <input type="number" id="divisor" value="1">
                        </div>
                        <div class="mapping-item">
                            <label>Profit %</label>
                            <input type="number" id="profit-margin" value="0">
                        </div>
                        <div class="mapping-item">
                            <label>Threshold %</label>
                            <input type="number" id="match-threshold" value="20">
                        </div>
                    </div>
                    <button class="run-btn" style="margin-top:12px;" onclick="runSmartMatcher()">üéØ Smart Match</button>
                </div>

                <!-- Stats -->
                <div class="matcher-stats" id="matcher-stats" style="display:none;">
                    <div class="matcher-stat">
                        <div class="value" style="color:var(--text-1);" id="m-total">0</div>
                        <div class="label">Total</div>
                    </div>
                    <div class="matcher-stat">
                        <div class="value" style="color:var(--green);" id="m-matched">0</div>
                        <div class="label">Matched</div>
                    </div>
                    <div class="matcher-stat">
                        <div class="value" style="color:var(--red);" id="m-unmatched">0</div>
                        <div class="label">Unmatched</div>
                    </div>
                </div>

                <!-- Results -->
                <div class="card">
                    <div class="card-header">
                        <div class="card-icon">‚úÖ</div>
                        <div class="card-title">Match Results</div>
                    </div>
                    <div class="match-results" id="match-results">
                        <div style="text-align:center;color:var(--text-3);padding:30px;">
                            No results yet
                        </div>
                    </div>
                    <button class="run-btn"
                        style="margin-top:10px;background:linear-gradient(135deg,var(--cyan),var(--green));"
                        onclick="useMatchResultsForProcess()">üöÄ Use Results & Process</button>
                    <div class="grid-2" style="margin-top:10px;">
                        <button class="btn btn-success" onclick="exportMatchedCSV()">üì• Export CSV</button>
                        <button class="btn" onclick="clearMatchResults()">üóë Clear</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- ==================== CSV TAB ==================== -->
        <div id="tab-csv" class="tab-content">
            <div class="container">
                <div class="card">
                    <div class="card-header">
                        <div class="card-icon">üìä</div>
                        <div class="card-title">CSV Editor</div>
                    </div>
                    <button class="btn" style="width:100%;margin-bottom:12px;" onclick="loadCSVForEdit()">üìÇ Load CSV
                        File</button>
                    <div class="table-wrap">
                        <table>
                            <thead>
                                <tr>
                                    <th>#</th>
                                    <th>Brand</th>
                                    <th>Model</th>
                                    <th>Storage</th>
                                    <th>Price</th>
                                    <th>Image</th>
                                    <th>√ó</th>
                                </tr>
                            </thead>
                            <tbody id="csv-edit-body">
                                <tr>
                                    <td colspan="7" style="text-align:center;color:var(--text-3);padding:20px;">Load a
                                        CSV
                                        file</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div class="grid-2" style="margin-top:10px;">
                        <button class="btn" onclick="addCSVRow()">+ Add Row</button>
                        <button class="btn btn-success" onclick="saveCSVEdits()">üíæ Save</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- ==================== SETTINGS TAB ==================== -->
        <div id="tab-settings" class="tab-content">
            <div class="container">
                <!-- Layer Mapping v3 - Fully Dynamic -->
                <div class="card">
                    <div class="card-header" style="display:flex;justify-content:space-between;align-items:center;">
                        <div style="display:flex;align-items:center;gap:8px;">
                            <div class="card-icon">üè∑Ô∏è</div>
                            <div class="card-title">Column ‚Üî Layer Mapping</div>
                        </div>
                        <div style="display:flex;gap:6px;">
                            <button class="btn" onclick="resetMappingsToDefault()"
                                style="padding:4px 8px;font-size:9px;background:var(--bg-4);">üîÑ Reset</button>
                            <button class="btn" onclick="addMapping()" style="padding:4px 10px;font-size:9px;">‚ûï
                                Add</button>
                        </div>
                    </div>

                    <!-- Header Labels -->
                    <div
                        style="display:grid;grid-template-columns:1fr 20px 1fr 30px;gap:8px;padding:8px 0;border-bottom:1px dashed var(--border);margin-bottom:10px;">
                        <div
                            style="font-size:9px;color:var(--accent-2);text-transform:uppercase;font-weight:600;text-align:center;">
                            CSV Column</div>
                        <div></div>
                        <div
                            style="font-size:9px;color:var(--accent-1);text-transform:uppercase;font-weight:600;text-align:center;">
                            PSD Layer</div>
                        <div></div>
                    </div>

                    <!-- All Mappings Container (dynamic) -->
                    <div id="all-mappings-container"></div>

                    <!-- Add Mapping Button (alternative) -->
                    <div style="text-align:center;padding:10px 0;border-top:1px dashed var(--border);margin-top:10px;">
                        <button class="btn" onclick="addMapping()" style="padding:8px 20px;font-size:10px;width:100%;">‚ûï
                            Add New Mapping</button>
                    </div>

                    <div style="margin-top:12px;padding-top:10px;border-top:1px dashed var(--border);">
                        <div class="mapping-item">
                            <label>JPG Quality</label>
                            <input type="number" id="jpg-quality" value="12" min="1" max="12" style="width:60px;">
                        </div>
                    </div>
                </div>

                <!-- Display Options -->
                <div class="card">
                    <div class="card-header">
                        <div class="card-icon">üëÅÔ∏è</div>
                        <div class="card-title">Display Options</div>
                    </div>
                    <div style="display:flex;flex-direction:column;gap:10px;">
                        <label
                            style="display:flex;align-items:center;gap:10px;padding:10px;background:var(--bg-3);border-radius:8px;cursor:pointer;">
                            <input type="checkbox" id="hide-price" style="width:18px;height:18px;">
                            <span>üö´ Hide Price for All Products</span>
                        </label>
                        <label
                            style="display:flex;align-items:center;gap:10px;padding:10px;background:var(--bg-3);border-radius:8px;cursor:pointer;">
                            <input type="checkbox" id="hide-storage-ram" style="width:18px;height:18px;">
                            <span>üö´ Hide Storage & RAM for All Products</span>
                        </label>
                        <div
                            style="padding:10px;background:rgba(0,206,201,0.1);border:1px solid var(--cyan);border-radius:8px;font-size:10px;color:var(--cyan);">
                            üí° Note: Storage & RAM are automatically hidden for iPhone products only (not all Apple
                            products)
                        </div>
                    </div>
                </div>

                <!-- Metadata Injection -->
                <div class="card">
                    <div class="card-header">
                        <div class="card-icon">üìã</div>
                        <div class="card-title">Metadata Injection</div>
                    </div>
                    <div style="display:flex;flex-direction:column;gap:12px;">
                        <!-- Enable Toggle -->
                        <label
                            style="display:flex;align-items:center;gap:10px;padding:10px;background:var(--bg-3);border-radius:8px;cursor:pointer;">
                            <input type="checkbox" id="enable-metadata" style="width:18px;height:18px;">
                            <span>‚ú® Enable Metadata Injection</span>
                        </label>

                        <!-- Metadata Fields -->
                        <div id="metadata-fields"
                            style="display:none;padding:12px;background:var(--bg-3);border-radius:8px;">
                            <div style="display:grid;grid-template-columns:1fr 1fr;gap:10px;">
                                <div class="mapping-item">
                                    <label style="display:flex;align-items:center;gap:4px;">
                                        üìù Description Column
                                    </label>
                                    <input type="text" id="meta-description-col" value="Description"
                                        placeholder="Column name">
                                </div>
                                <div class="mapping-item">
                                    <label style="display:flex;align-items:center;gap:4px;">
                                        üè∑Ô∏è Keywords Column
                                    </label>
                                    <input type="text" id="meta-keywords-col" value="Keywords"
                                        placeholder="Column name">
                                </div>
                            </div>

                            <div style="margin-top:10px;display:grid;grid-template-columns:1fr 1fr;gap:10px;">
                                <div class="mapping-item">
                                    <label>üìõ Title Template</label>
                                    <input type="text" id="meta-title-template" value="{Brand} {Model}"
                                        placeholder="e.g. {Brand} {Model}">
                                </div>
                                <div class="mapping-item">
                                    <label>‚úçÔ∏è Author / Copyright</label>
                                    <input type="text" id="meta-author" value="" placeholder="Your name or brand">
                                </div>
                            </div>

                            <div
                                style="margin-top:10px;padding:8px;background:rgba(255,138,0,0.1);border-radius:6px;font-size:9px;color:var(--accent-1);">
                                üí° Use {AnyColumnName} as placeholder - matches your CSV column names!
                            </div>
                        </div>
                    </div>
                </div>

                <!-- License Management -->
                <div class="card">
                    <div class="card-header">
                        <div class="card-icon">üîê</div>
                        <div class="card-title">License</div>
                    </div>
                    <div style="display:flex;flex-direction:column;gap:10px;">
                        <div id="license-info"
                            style="padding:10px;background:var(--bg-3);border-radius:8px;font-size:10px;">
                            <span style="color:var(--text-3);">Machine ID: </span>
                            <span id="display-machine-id"
                                style="color:var(--accent-1);font-family:monospace;">Loading...</span>
                        </div>
                        <button class="btn"
                            style="background:linear-gradient(135deg,#ef4444,#dc2626);border:none;color:white;"
                            onclick="resetLicense()">
                            üîÑ Reset License
                        </button>
                        <div
                            style="padding:8px;background:rgba(239,68,68,0.1);border:1px solid rgba(239,68,68,0.3);border-radius:8px;font-size:9px;color:#ef4444;">
                            ‚ö†Ô∏è This will remove your license and require re-activation
                        </div>
                    </div>
                </div>


            </div>
        </div>

        <!-- ==================== STATS TAB ==================== -->
        <div id="tab-stats" class="tab-content">
            <div class="container">
                <div class="card">
                    <div class="card-header">
                        <div class="card-icon">üìà</div>
                        <div class="card-title">Statistics</div>
                    </div>
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-value purple" id="stat-total">0</div>
                            <div class="stat-label">Total</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value green" id="stat-success">0</div>
                            <div class="stat-label">Success</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value red" id="stat-failed">0</div>
                            <div class="stat-label">Failed</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value yellow" id="stat-time">0s</div>
                            <div class="stat-label">Time</div>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header" style="display:flex;justify-content:space-between;align-items:center;">
                        <div style="display:flex;align-items:center;gap:8px;">
                            <div class="card-icon">üìú</div>
                            <div class="card-title">Session History</div>
                            <span id="session-count"
                                style="font-size:9px;background:var(--bg-3);padding:2px 8px;border-radius:10px;color:var(--text-3);">0</span>
                        </div>
                        <button class="btn" onclick="clearSessionHistory()" style="padding:4px 10px;font-size:9px;">üóëÔ∏è
                            Clear</button>
                    </div>
                    <div id="session-history" style="max-height:200px;overflow-y:auto;scrollbar-width:thin;">
                        <div style="text-align:center;color:var(--text-3);padding:20px;font-size:10px;">No sessions
                        </div>
                    </div>
                </div>


            </div>
        </div>

        <!-- Footer -->
        <div class="footer">
            üìã Made with <span class="heart">‚ô•</span> by Abdalla ‚Ä¢ ListMatic <span
                style="color:var(--accent-1);">v2.0</span>
        </div>

        <script src="./lib/CSInterface.js"></script>
        <script>
            // Toggle checkbox
            function toggleCheck(el, id) {
                el.classList.toggle('active');
                document.getElementById(id).checked = el.classList.contains('active');
            }

            // Clear match results
            function clearMatchResults() {
                document.getElementById('match-results').innerHTML = '<div style="text-align:center;color:var(--text-3);padding:30px;">No results yet</div>';
                document.getElementById('matcher-stats').style.display = 'none';
                matchResults = [];
            }

            // Smart Matcher Variables
            var masterData = [];
            var matchResults = [];

            // Reset License function
            function resetLicense() {
                if (confirm('ŸáŸÑ ÿ£ŸÜÿ™ ŸÖÿ™ÿ£ŸÉÿØ ŸÖŸÜ ÿ•ÿπÿßÿØÿ© ÿ™ÿπŸäŸäŸÜ ÿßŸÑÿ™ÿ±ÿÆŸäÿµÿü\nÿ≥Ÿäÿ™ÿ∑ŸÑÿ® Ÿáÿ∞ÿß ÿ•ÿØÿÆÿßŸÑ ÿßŸÑÿ≥Ÿäÿ±ŸäÿßŸÑ ŸÖÿ±ÿ© ÿ£ÿÆÿ±Ÿâ.')) {
                    localStorage.removeItem('miami_panel_license');
                    location.reload();
                }
            }

            // Display Machine ID on page load
            document.addEventListener('DOMContentLoaded', function () {
                const machineIdDisplay = document.getElementById('display-machine-id');
                if (machineIdDisplay) {
                    machineIdDisplay.textContent = generateMachineId();
                }
            });
        </script>
        <script src="./main.js"></script>
    </div> <!-- End of main-content wrapper -->
</body>

</html>